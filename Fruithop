getgenv().FruitWebhook = "" -- Coloque sua webhook aqui
getgenv().team = "Pirates"

repeat task.wait() until game:IsLoaded() and game:GetService("Players").LocalPlayer

local Players, ReplicatedStorage, TweenService, HttpService, TeleportService =
    game:GetService("Players"),
    game:GetService("ReplicatedStorage"),
    game:GetService("TweenService"),
    game:GetService("HttpService"),
    game:GetService("TeleportService")

local plr = Players.LocalPlayer
local Config = {AutoFruit = true, AutoStoreFruit = true, FruitLog = {}}

-- Funções de log
local function LoadFruitLog()
    if isfile("fruitlog.json") then
        Config.FruitLog = HttpService:JSONDecode(readfile("fruitlog.json"))
    end
end
local function SaveFruitLog()
    writefile("fruitlog.json", HttpService:JSONEncode(Config.FruitLog))
end
local function LogFruit(fruitName)
    table.insert(Config.FruitLog, {fruit = fruitName, time = os.date("%Y-%m-%d %H:%M:%S")})
    SaveFruitLog()
end

-- Funções de coleta e ESP
local function FindBasePart(model)
    for _, v in ipairs(model:GetDescendants()) do
        if v:IsA("BasePart") then return v end
    end
end

local function CollectItem(item)
    if not item then return false end
    local partToTeleportTo = nil
    local fruitName = "Fruit Model"
    if item:IsA("Tool") then
        partToTeleportTo = item:FindFirstChild("Handle")
        fruitName = item.Name
    elseif item:IsA("Model") and (item.Name:lower() == "fruit") then
        partToTeleportTo = FindBasePart(item)
    end
    if partToTeleportTo then
        local startTime = tick()
        repeat
            if plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
                plr.Character.HumanoidRootPart.CFrame = partToTeleportTo.CFrame + Vector3.new(0, 3, 0)
            end
            task.wait(0.3)
        until not item:IsDescendantOf(workspace) or tick() - startTime > 10
        if not item:IsDescendantOf(workspace) then
            LogFruit(fruitName)
            return true
        end
    end
    return false
end

local function AddFruitESP(fruit)
    if fruit:IsA("Tool") or (fruit:IsA("Model") and fruit.Name:lower() == "fruit") then
        if not fruit:FindFirstChild("FruitESP") then
            local highlight = Instance.new("Highlight")
            highlight.Name = "FruitESP"
            highlight.FillColor = Color3.fromRGB(0, 255, 0)
            highlight.FillTransparency = 0.5
            highlight.OutlineColor = Color3.fromRGB(255, 255, 255)
            highlight.OutlineTransparency = 0
            highlight.Parent = fruit
        end
    end
end

for _, obj in ipairs(workspace:GetChildren()) do
    AddFruitESP(obj)
end
workspace.ChildAdded:Connect(function(obj)
    task.wait(0.5)
    AddFruitESP(obj)
end)

-- GUI
local function CreateUI()
    local ui = {}
    local ScreenGui = Instance.new("ScreenGui", game:GetService("CoreGui"))
    ScreenGui.Name = "FruitFinder_GUI"
    local MainFrame = Instance.new("Frame", ScreenGui)
    local Author = Instance.new("TextLabel", MainFrame)
    local StatusLabel = Instance.new("TextLabel", MainFrame)
    local Led = Instance.new("Frame", MainFrame)

    MainFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    MainFrame.BackgroundTransparency = 0.3
    MainFrame.Position = UDim2.new(0.5, -150, 0.55, 0)
    MainFrame.Size = UDim2.new(0, 300, 0, 90)
    Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0, 8)

    Author.BackgroundTransparency = 1
    Author.Position = UDim2.new(0, 0, 0, 5)
    Author.Size = UDim2.new(1, 0, 0, 25)
    Author.Font = Enum.Font.GothamBold
    Author.Text = "Night Mystic Find Fruit"
    Author.TextColor3 = Color3.fromRGB(65, 165, 255)
    Author.TextSize = 20
    Author.TextStrokeTransparency = 0.8
    Author.TextXAlignment = Enum.TextXAlignment.Center

    StatusLabel.BackgroundTransparency = 1
    StatusLabel.Position = UDim2.new(0, 40, 0, 35)
    StatusLabel.Size = UDim2.new(1, -50, 0, 30)
    StatusLabel.Font = Enum.Font.GothamBold
    StatusLabel.Text = "Status: Iniciando..."
    StatusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    StatusLabel.TextSize = 20
    StatusLabel.TextStrokeTransparency = 0.8
    StatusLabel.TextXAlignment = Enum.TextXAlignment.Left

    Led.Size = UDim2.new(0, 20, 0, 20)
    Led.Position = UDim2.new(0, 10, 0, 40)
    Led.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
    Instance.new("UICorner", Led).CornerRadius = UDim.new(1, 0)

    local function animateLed(color)
        TweenService:Create(Led, TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {BackgroundColor3 = color}):Play()
    end

    ui.updateStatus = function(status)
        if status == "Searching..." then
            StatusLabel.Text = "Status: Procurando..."
            animateLed(Color3.fromRGB(255, 165, 0))
        elseif status:find("Found Tool Fruit") then
            StatusLabel.Text = "Status: Fruta encontrada (" .. status:gsub("Found Tool Fruit: ", "") .. ")"
            animateLed(Color3.fromRGB(0, 255, 0))
        elseif status:find("Found Model Fruit") then
            StatusLabel.Text = "Status: Fruta encontrada (Modelo)"
            animateLed(Color3.fromRGB(0, 255, 0))
        elseif status == "Storing Fruits" then
            StatusLabel.Text = "Status: Guardando frutas..."
            animateLed(Color3.fromRGB(65, 105, 225))
        elseif status:find("Server Hopping") then
            StatusLabel.Text = "Status: Trocando de servidor..."
            animateLed(Color3.fromRGB(255, 255, 0))
        else
            StatusLabel.Text = "Status: " .. status
            animateLed(Color3.fromRGB(255, 0, 0))
        end
    end

    LoadFruitLog()
    return ui
end

-- Auto Store
local function HandleAutoStore(tool)
    if Config.AutoStoreFruit and tool:IsA("Tool") and tool.Name:find("Fruit") then
        task.spawn(function()
            ReplicatedStorage.Remotes.CommF_:InvokeServer("StoreFruit", tool:GetAttribute("OriginalName"), tool)
        end)
    end
end

task.spawn(function()
    while task.wait(1) do
        if Config.AutoStoreFruit then
            pcall(function()
                for _, fr in ipairs(plr.Backpack:GetChildren()) do
                    HandleAutoStore(fr)
                end
                for _, fr in ipairs(plr.Character:GetChildren()) do
                    HandleAutoStore(fr)
                end
            end)
        end
    end
end)

plr.CharacterAdded:Connect(function(char)
    char.ChildAdded:Connect(HandleAutoStore)
end)
if plr.Character then
    plr.Character.ChildAdded:Connect(HandleAutoStore)
end

-- Webhook dinâmica
local comm = ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("CommF_")
local function sendWebhook(fruta)
    local webhook = getgenv().FruitWebhook or ""
    if webhook == "" then return end
    local data = {
        ["username"] = "Night Webhook",
        ["avatar_url"] = "https://cdn.discordapp.com/attachments/1427018910976315492/1435001604167438426/432a0cb6-b3da-4a3f-85df-9794da07e761.jpg",
        ["embeds"] = {{
            ["title"] = "Fruit Finder Notification",
            ["description"] = "Uma fruta foi armazenada no inventário!",
            ["color"] = 139,
            ["fields"] = {
                {["name"] = "Jogador", ["value"] = plr.Name, ["inline"] = true},
                {["name"] = "Fruta", ["value"] = fruta or "Desconhecida", ["inline"] = true},
            }
        }}
    }
    local req = http_request or request or (syn and syn.request)
    if req then
        req({
            Url = webhook,
            Method = "POST",
            Headers = {["Content-Type"] = "application/json"},
            Body = HttpService:JSONEncode(data)
        })
    end
end

local old
old = hookmetamethod(game, "__namecall", function(self, ...)
    local args = {...}
    local method = getnamecallmethod()
    if self == comm and method == "InvokeServer" and args[1] == "StoreFruit" then
        local result = old(self, ...)
        if result == true or result == "Sucess" then
            sendWebhook(args[2])
        end
        return result
    end
    return old(self, ...)
end)

repeat wait() until game.Players.LocalPlayer:FindFirstChild("DataLoaded")

if game:GetService("Players").LocalPlayer.PlayerGui:FindFirstChild("Main (minimal)") then
    repeat
        task.wait(1)
        local l_Remotes_0 = game.ReplicatedStorage:WaitForChild("Remotes")
        l_Remotes_0.CommF_:InvokeServer("SetTeam", getgenv().team)
    until not game:GetService("Players").LocalPlayer.PlayerGui:FindFirstChild("Main (minimal)")
end

local function StartFruitFinder()
    local ui = CreateUI()
    local lastServerHop = tick()
    local collecting = false
    while task.wait() do
        if Config.AutoFruit and not collecting then
            pcall(function()
                local foundFruit = false
                local collected = false
                for _, v in ipairs(workspace:GetChildren()) do
                    if v:IsA("Tool") and v.Name:lower():find("fruit") then
                        foundFruit = true
                        collecting = true
                        ui.updateStatus("Found Tool Fruit: " .. v.Name)
                        if CollectItem(v) then collected = true end
                        collecting = false
                        break
                    end
                end
                if not collected then
                    for _, v in ipairs(workspace:GetChildren()) do
                        if v:IsA("Model") and v.Name:lower() == "fruit" then
                            foundFruit = true
                            collecting = true
                            ui.updateStatus("Found Model Fruit")
                            if CollectItem(v) then collected = true end
                            collecting = false
                            break
                        end
                    end
                end
                if collected and Config.AutoStoreFruit then
                    ui.updateStatus("Storing Fruits")
                    task.wait(1)
                end
                if not foundFruit and tick() - lastServerHop >= 3 then
                    ui.updateStatus("Server Hopping...")
                    task.wait(1)
                    lastServerHop = tick()
                    local success, servers = pcall(function()
                        return HttpService:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/" .. game.PlaceId .. "/servers/Public?sortOrder=Asc&limit=100"))
                    end)
                    if success and servers and #servers.data > 0 then
                        local server = servers.data[math.random(1, #servers.data)]
                        if server and server.id ~= game.JobId then
                            TeleportService:TeleportToPlaceInstance(game.PlaceId, server.id)
                        else
                            ui.updateStatus("Falha ao encontrar servidor diferente.")
                        end
                    else
                        ui.updateStatus("Falha ao obter lista de servidores.")
                    end
                end
            end)
        end
    end
end

print("by araujo7xp - Script iniciado.")
StartFruitFinder()
